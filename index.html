<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>IGNOU BCom Solved Assignments</title>
  <meta name="description" content="Solved assignments for IGNOU BCom students. Search, filter and download PDFs." />
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa4b2;--accent:#7dd3fc;--glass: rgba(255,255,255,0.03)}
    *{box-sizing:border-box}
    body{font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial; margin:0; background:linear-gradient(180deg,#071024 0%, #081429 100%); color:#e6eef6;}
    .wrap{max-width:1100px;margin:32px auto;padding:20px}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{margin:0;font-size:20px}
    .subtitle{color:var(--muted);font-size:13px}
    .controls{display:flex;gap:12px;flex-wrap:wrap;margin-top:18px}
    .search{flex:1;min-width:220px}
    input,select,textarea,button{background:var(--glass);border:1px solid rgba(255,255,255,0.04);padding:10px;border-radius:10px;color:inherit}
    input::placeholder{color:var(--muted)}
    button.primary{background:linear-gradient(90deg,#0ea5e9,#60a5fa);color:#052024;border:none}
    .filters{display:flex;gap:8px;align-items:center}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px;margin-top:18px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);}
    .meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
    .course{font-weight:700}
    .small{font-size:13px;color:var(--muted)}
    .actions{display:flex;gap:8px;margin-top:10px}
    a.btn{display:inline-block;padding:8px 10px;border-radius:8px;text-decoration:none;font-size:14px}
    a.download{background:rgba(125,211,252,0.12);border:1px solid rgba(125,211,252,0.18)}
    a.view{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.03)}
    .tag{display:inline-block;padding:6px 8px;border-radius:999px;font-size:12px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03);}
    .empty{padding:40px;text-align:center;color:var(--muted)}
    footer{margin-top:28px;color:var(--muted);font-size:13px}
    /* admin modal */
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(2,6,23,0.6), rgba(2,6,23,0.85));}
    .modal.open{display:flex}
    .modal-card{background:#071426;padding:16px;border-radius:12px;max-width:900px;width:94%;border:1px solid rgba(255,255,255,0.03)}
    textarea.json{width:100%;height:300px;background:#021026;border-radius:8px;padding:12px;color:#cfeeff;font-family:monospace}
    .hint{color:var(--muted);font-size:13px}
    @media (max-width:520px){header{flex-direction:column;align-items:flex-start} .controls{flex-direction:column}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>IGNOU BCom Solved Assignments</h1>
        <div class="subtitle">Search, filter and download solved assignments â€” hosted on GitHub Pages</div>
      </div>
      <div style="text-align:right">
        <div class="small">Built for: IGNOU BCom students</div>
        <button id="adminBtn" class="primary" style="margin-top:8px">Admin: Paste JSON</button>
      </div>
    </header>

    <div class="controls">
      <input id="search" class="search" placeholder="Search by course code, title or description (e.g., 'BCOM', 'BEGE-101')" />
      <div class="filters">
        <select id="filterCourse"><option value="">All courses</option></select>
        <select id="filterSession"><option value="">All sessions</option></select>
        <select id="filterYear"><option value="">All years</option></select>
        <button id="clearFilters">Clear</button>
      </div>
    </div>

    <div id="list" class="grid"></div>
    <div id="empty" class="empty" style="display:none">No assignments found. Try different search terms or filters.</div>

    <footer>
      <div>Tip: To add assignment PDFs, upload them to <code>assets/</code> in your GitHub repo and set the <code>file</code> URL accordingly in the JSON.</div>
    </footer>
  </div>

  <!-- Admin modal -->
  <div id="modal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-card">
      <h3>Admin: Paste assignments JSON</h3>
      <div class="hint">Paste a JSON array of assignment objects. This updates the site in your browser (client-side). To make permanent, commit changes to index.html or host a separate assignments.json.
      </div>
      <textarea id="jsonInput" class="json" placeholder='[ {"id": "1","title":"...","course":"BEGC-101","year":"2024","session":"Jan-Jun 2024","description":"...","file":"assets/BEGC-101-Jan2024.pdf","preview": "https://example.com/preview.png"} ]'></textarea>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px">
        <button id="closeModal">Close</button>
        <button id="loadJson" class="primary">Load JSON</button>
      </div>
    </div>
  </div>

  <script>
    // Default sample assignments
    let assignments = [
      {
        id: "B1",
        title: "BEGE-101 - Solved Assignment (Jan 2024)",
        course: "BEGE-101",
        year: "2024",
        session: "Jan-Jun 2024",
        description: "Solved answers for BEGE-101 English course - IGNOU BCom.",
        file: "assets/BEGE-101-Jan2024.pdf",
        preview: ""
      },
      {
        id: "B2",
        title: "BCOM-101 - Solved Assignment (Jul 2023)",
        course: "BCOM-101",
        year: "2023",
        session: "Jul-Dec 2023",
        description: "Solved assignment covering unit 1-4.",
        file: "assets/BCOM-101-Jul2023.pdf",
        preview: ""
      }
    ];

    // Utility: render filters and list
    const listEl = document.getElementById('list');
    const emptyEl = document.getElementById('empty');
    const searchEl = document.getElementById('search');
    const fCourse = document.getElementById('filterCourse');
    const fSession = document.getElementById('filterSession');
    const fYear = document.getElementById('filterYear');

    function unique(vals){return [...new Set(vals)].sort()}

    function populateFilters(){
      const courses = unique(assignments.map(a=>a.course).filter(Boolean));
      const sessions = unique(assignments.map(a=>a.session).filter(Boolean));
      const years = unique(assignments.map(a=>a.year).filter(Boolean));
      fCourse.innerHTML = '<option value="">All courses</option>' + courses.map(c=>`<option value="${c}">${c}</option>`).join('');
      fSession.innerHTML = '<option value="">All sessions</option>' + sessions.map(s=>`<option value="${s}">${s}</option>`).join('');
      fYear.innerHTML = '<option value="">All years</option>' + years.map(y=>`<option value="${y}">${y}</option>`).join('');
    }

    function renderList(){
      const q = searchEl.value.trim().toLowerCase();
      const cf = fCourse.value; const sf = fSession.value; const yf = fYear.value;
      const filtered = assignments.filter(a=>{
        if(cf && a.course !== cf) return false;
        if(sf && a.session !== sf) return false;
        if(yf && a.year !== yf) return false;
        if(!q) return true;
        return (a.title||'').toLowerCase().includes(q) || (a.course||'').toLowerCase().includes(q) || (a.description||'').toLowerCase().includes(q) || (a.year||'').toLowerCase().includes(q);
      });
      listEl.innerHTML = '';
      if(filtered.length === 0){ emptyEl.style.display='block'; return } else { emptyEl.style.display='none' }
      for(const a of filtered){
        const card = document.createElement('div'); card.className='card';
        card.innerHTML = `
          <div class="meta">
            <div>
              <div class="course">${escapeHtml(a.course||'Unknown')}</div>
              <div class="small">${escapeHtml(a.title||'Untitled')}</div>
            </div>
            <div style="text-align:right">
              <div class="tag">${escapeHtml(a.session||'')}</div>
              <div class="small">${escapeHtml(a.year||'')}</div>
            </div>
          </div>
          <div class="small">${escapeHtml(a.description||'No description')}</div>
          <div class="actions">
            <a class="btn view" target="_blank" rel="noopener" href="${a.preview?escapeAttr(a.preview):escapeAttr(a.file)}">Preview</a>
            <a class="btn download" target="_blank" rel="noopener" href="${escapeAttr(a.file)}" download>Download</a>
            <a class="btn" target="_blank" rel="noopener" href="https://github.com/">Source</a>
          </div>
        `;
        listEl.appendChild(card);
      }
    }

    // Basic escaping
    function escapeHtml(s){ if(!s) return ''; return s.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;') }
    function escapeAttr(s){ if(!s) return ''; return s.replaceAll('"','%22') }

    // Wire up events
    searchEl.addEventListener('input', renderList);
    fCourse.addEventListener('change', renderList);
    fSession.addEventListener('change', renderList);
    fYear.addEventListener('change', renderList);
    document.getElementById('clearFilters').addEventListener('click', ()=>{searchEl.value=''; fCourse.value=''; fSession.value=''; fYear.value=''; renderList()});

    // Admin modal logic
    const modal = document.getElementById('modal');
    document.getElementById('adminBtn').addEventListener('click', ()=>{
      document.getElementById('jsonInput').value = JSON.stringify(assignments, null, 2);
      modal.classList.add('open');
    });
    document.getElementById('closeModal').addEventListener('click', ()=> modal.classList.remove('open'));
    document.getElementById('loadJson').addEventListener('click', ()=>{
      const v = document.getElementById('jsonInput').value;
      try{
        const parsed = JSON.parse(v);
        if(!Array.isArray(parsed)) throw new Error('JSON must be an array of assignment objects');
        assignments = parsed.map(p=>({id: p.id||Math.random().toString(36).slice(2,9), title:p.title||'',course:p.course||'',year:p.year||'',session:p.session||'',description:p.description||'',file:p.file||'',preview:p.preview||''}));
        populateFilters(); renderList(); modal.classList.remove('open');
        alert('Loaded assignments into the page. To make permanent, copy this JSON into your repo or update index.html on GitHub.');
      }catch(err){ alert('Invalid JSON: '+err.message) }
    });

    // Initial render
    populateFilters(); renderList();

    // Optional: allow index.html to fetch assignments.json if you choose to host it separately
    (async function tryFetchAssignments(){
      try{
        const res = await fetch('assignments.json');
        if(res.ok){
          const data = await res.json();
          if(Array.isArray(data) && data.length>0){ assignments = data; populateFilters(); renderList(); }
        }
      }catch(e){ /* ignore */ }
    })();

  </script>
</body>
</html>
